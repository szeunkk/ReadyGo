아래의 조건을 모두 적용하여, 아래의 요구사항을 모두 구현할 것.
구현 결과를 체크리스트로 반환할 것.

==============================================

조건-커서룰) 아래의 커서룰을 적용하여 작업하고, 이 작업이 끝나면 해당 rules 적용 결과를 체크리스트로 반환할 것.
	- Service / API / Repository / Domain 책임을 엄격히 분리할 것
	- API Route는 인증 + 입력 검증 + Service 호출만 담당할 것
	- Service Layer는 오케스트레이션만 수행할 것
	- Domain 로직, UI 로직, ViewModel 변환 로직 포함 금지
	- throw로 전체 플로우를 중단하지 말고, "정상 실패 상태"를 명시적으로 처리할 것
	- default export 금지, named export만 허용
	- Supabase client는 외부에서 주입받을 것
	- 로그/상태 기록은 전용 테이블에만 수행할 것

==============================================

조건-파일경로) 참고 및 기준 파일 경로는 다음과 같다.
	- API Route
		- src/app/api/steam/sync/route.ts
	- Service
		- src/services/steam/syncSteamGames.service.ts
	- Steam API Client
		- src/services/steam/steamApiClient.ts
	- Repository
		- src/repositories/steamUserGamesRepository.ts
		- src/repositories/steamSyncLogRepository.ts
		- src/repositories/userProfiles.repository.ts
	- DB Table (존재 전제)
		- steam_user_games
		- steam_sync_logs
		- user_profiles

==============================================

조건-구현참고) 반드시 참고할 기존 구현 패턴은 다음과 같다.
	- Profile / Match Service 구조와 동일한 Layered Architecture
	- Repository는 단일 테이블 + 단일 책임 조회/저장만 수행
	- Service는 여러 Repository를 조합하는 오케스트레이터
	- API Route는 auth.getUser() 기반 viewerId 추출 패턴 사용
	- 실패 케이스도 "정상 응답 + 상태 코드/결과값"으로 처리하는 기존 정책 준수

==============================================

핵심요구사항) 다음 기능을 step-by-step으로 구현하고, 각 항목의 적용 여부를 체크리스트로 반환할 것.

1. Sync 단일 진입점 정의
	- POST /api/steam/sync API Route 생성
	- body로 userId를 받지 않는다
	- viewerId는 쿠키/세션 기반 auth.getUser()로만 획득
	- 응답은 아래 형태로 고정
		{
		  status: "success" | "failed" | "private" | "not_linked" | "invalid_steam_id"
		  syncedGamesCount: number
		}

2. SteamID 검증 & 동기화 가능 조건
	- user_profiles에서 viewerId 기준 steam_id 조회
	- steam_id 없을 경우
		- steam_sync_logs에 status=not_linked 기록
		- API는 200 OK + syncedGamesCount=0 반환
	- steam_id가 64-bit 형식이 아닐 경우
		- 변환 가능하면 변환
		- 불가능하면 status=invalid_steam_id로 로그 후 종료
	- 위 케이스들에서 throw 사용 금지

3. Steam API 호출 (Owned Games)
	- 서버 전용 Steam API 호출 함수 구현 (steamApiClient.ts)
	- IPlayerService/GetOwnedGames/v0001/ 사용
	- include_appinfo=1, include_played_free_games=1
	- 네트워크/타임아웃 오류 시
		- status=failed 로그 기록
		- syncedGamesCount=0으로 종료
	- games 필드가 없거나 접근 불가 응답일 경우
		- status=private 처리

4. Steam 응답 → 저장 스키마 매핑
	- steam_user_games row로 변환
	- 필드 매핑 규칙 엄수
		- app_id ← appid
		- name ← name (없으면 null)
		- playtime_forever ← playtime_forever
		- playtime_recent ← playtime_2weeks (없으면 null)
		- last_played ← rtime_last_played → timestamptz (없으면 null)
	- "의미적 기본값 생성" 금지

5. Upsert 전략
	- (user_id, app_id) unique 기준 bulk upsert
	- 갱신 컬럼:
		- name
		- playtime_forever
		- playtime_recent
		- last_played
	- 삭제/비활성화 정책은 이번 구현에서 제외

6. steam_sync_logs 기록
	- 모든 sync 시도에 대해 로그 남김
	- 성공 시
		- status=success
		- synced_games_count 기록
		- synced_at=now
	- 실패/예외 시
		- status=failed / private / not_linked / invalid_steam_id
		- synced_games_count=0
		- synced_at=now

==============================================

조건-Hook 책임)
	- 해당 없음 (이번 구현은 API + Service 중심)

==============================================

조건-UI 책임)
	- UI는 이 API를 단순 호출만 하며
	- 상태 해석/문구 변환/재시도 판단은 UI에서 수행
	- API는 "사실 상태"만 반환

==============================================

구현 완료 후 반환) 아래 체크리스트를 반드시 반환할 것.
	- POST /api/steam/sync 단일 진입점이 존재한다
	- viewerId를 body가 아닌 auth 세션에서만 획득한다
	- steam_id 없음/비공개/오류가 throw 없이 처리된다
	- Steam API 호출 로직이 Service/API에서 분리되어 있다
	- steam_user_games에 bulk upsert가 수행된다
	- steam_sync_logs가 모든 결과에 대해 기록된다
	- API 응답이 과한 데이터를 반환하지 않는다
	- Service / Repository / API 책임이 섞이지 않았다

